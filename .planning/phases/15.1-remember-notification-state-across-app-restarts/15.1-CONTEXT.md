# Phase 15.1: Remember Notification State across app restarts - Context

**Gathered:** 2026-02-26
**Status:** Ready for planning

<domain>
## Phase Boundary

Persist the titlebar notification bell toggle across app restarts. Currently `localState.notificationsEnabled` in `renderer.js` resets to `true` on every launch. The fix wires the bell to `settingsState` which already persists to `settings.json`.

</domain>

<decisions>
## Implementation Decisions

### Toggle source of truth
- Remove `localState.notificationsEnabled` entirely
- Wire the titlebar bell button directly to `settingsState.notificationsEnabled` (read and write)
- `settingsState` already auto-persists to `settings.json` via debounced save — no new persistence needed

### Startup UI state
- On app init, read `settingsState.notificationsEnabled` and set the bell button's `active`/`inactive` class accordingly
- If user disabled notifications last session, the bell appears inactive on next launch

### Settings panel
- No notification toggle in SettingsPanel — titlebar bell is the only toggle point
- Keep it simple, no duplicate controls

### Default value
- Default remains `true` (notifications enabled) for new installs
- This is already the default in `settings.state.js` line 17

### Claude's Discretion
- Exact refactoring approach for removing localState usage and wiring to settingsState
- Whether to use `isNotificationsEnabled()` helper or direct `getSetting('notificationsEnabled')`

</decisions>

<specifics>
## Specific Ideas

- The bug is in `renderer.js`: `localState.notificationsEnabled` (line 118) is a volatile in-memory variable, toggled at lines 1597-1599, never synced with `settingsState`
- `settingsState` already has `notificationsEnabled` with persistence — the infrastructure exists, just not wired to the UI

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 15.1-remember-notification-state-across-app-restarts*
*Context gathered: 2026-02-26*
