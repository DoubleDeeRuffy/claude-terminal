# Phase 2.1: Fix PR #13 Review Issues for Terminal Keyboard Shortcuts - Context

**Gathered:** 2026-02-26
**Status:** Ready for planning

<domain>
## Phase Boundary

Address three review issues from upstream maintainer (Sterll) on PR #13 (feat/terminal-keyboard-shortcuts). Fix the Ctrl+Left/Right Windows Snap bypass removal (blocker), rebase on current main to resolve PR #12 overlap, and flatten the nested terminalShortcuts settings to match the codebase's flat settings pattern. All work updates the existing `feat/terminal-keyboard-shortcuts` branch.

</domain>

<decisions>
## Implementation Decisions

### Ctrl+Left/Right interception strategy (Issue #1 — BLOCKER)
- Restore Ctrl+Left/Right in MainWindow.js `before-input-event` handler
- When word-jump setting is **enabled**: only call `event.preventDefault()` to block Windows Snap — do NOT send IPC, let the event propagate naturally to renderer where xterm handles word-jump
- When word-jump setting is **disabled**: call `event.preventDefault()` AND send `ctrl-arrow` left/right IPC to renderer for old tab-switching behavior (reuse existing IPC channel)
- Add `setCtrlArrowWordJumpEnabled` IPC handler in MainWindow.js — same pattern as existing `setCtrlTabEnabled`
- Sync word-jump setting to main process on startup and on settings change — mirrors ctrlTab sync pattern
- Relabel the setting in Shortcuts UI: make it clear this is "Word jump (Ctrl+←/→) — like Windows Terminal" so users understand enabling it replaces old tab-switching

### Rebase approach (Issue #2)
- Rebase `feat/terminal-keyboard-shortcuts` on top of main (which includes PR #12 changes)
- Claude decides whether to use fork's main or upstream main based on what's actually on each branch
- Resolve merge conflicts in TerminalManager.js during rebase
- Remove duplicated `findClaudeTerminalForProject` helper — use main's version from merged PR #8
- Keep as single squashed commit after all fixes applied

### Settings flattening convention (Issue #3)
- Flatten nested `terminalShortcuts` object to flat keys matching existing settings pattern
- Naming convention: `shortcut` prefix + key name + `Enabled`/`Key` suffix (camelCase)
- Full flat key list:
  - `shortcutCtrlCEnabled` (default: true)
  - `shortcutCtrlCKey` (default: 'C')
  - `shortcutCtrlVEnabled` (default: true)
  - `shortcutCtrlVKey` (default: 'V')
  - `shortcutCtrlArrowEnabled` (default: true)
  - `shortcutCtrlTabEnabled` (default: true)
  - `shortcutRightClickPasteEnabled` (default: true)
  - `shortcutRightClickCopyPasteEnabled` (default: false)
- Remove deep-merge logic from `loadSettings()` entirely — flat keys use standard `{ ...defaultSettings, ...saved }` spread like all other settings
- No migration shim for old nested format — clean break
- Update all consumers: TerminalManager.js key handler, ShortcutsManager.js toggle UI, MainWindow.js IPC sync

### Claude's Discretion
- Choosing fork main vs upstream main for rebase base (inspect actual branch state)
- Exact conflict resolution strategy during rebase
- Whether `event.preventDefault()` alone is sufficient to block Windows Snap while allowing natural propagation, or if a different approach is needed
- Keeping `terminalContextMenu` setting or folding it into the flat shortcut keys

</decisions>

<specifics>
## Specific Ideas

- Sterll's review explicitly says the `before-input-event` intercept exists "specifically to prevent Windows from snapping the window" — this is the core reason Ctrl+Left/Right must be intercepted even when they no longer switch tabs
- The ctrlTab IPC pattern (flag + setCtrlTabEnabled + startup sync) is the established pattern to follow for ctrlArrow word-jump setting sync
- PR uses squash-merge workflow — single clean commit per the squash PR playbook

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 2.1-fix-pr-13-review-issues-for-terminal-keyboard-shortcuts*
*Context gathered: 2026-02-26*
