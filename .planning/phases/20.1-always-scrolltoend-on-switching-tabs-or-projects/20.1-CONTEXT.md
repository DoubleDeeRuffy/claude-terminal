# Phase 20.1: Always ScrollToEnd on Switching Tabs or Projects - Context

**Gathered:** 2026-02-27
**Status:** Ready for planning

<domain>
## Phase Boundary

Ensure terminal tabs always show the latest output when the user switches between tabs or projects. This is runtime navigation behavior — separate from Phase 6.2's startup/restore scroll logic.

</domain>

<decisions>
## Implementation Decisions

### Scroll trigger scope
- Auto-scroll-to-bottom on terminal **tab switches** and **project switches**
- Does NOT trigger on other focus events (e.g., returning from settings panel)
- Separate concern from Phase 6.2 (startup/restore scroll) — both coexist independently

### Tab type handling
- **Terminal (xterm) tabs only** — scroll to bottom on switch
- Chat tabs keep their scroll position as-is (no auto-scroll)

### Scroll position override
- **Always scroll to bottom** — every tab/project switch forces scroll-to-end regardless of prior scroll position
- No "remember manual scroll position" logic — simple and predictable
- User can scroll up again after switching if they need history

### Settings toggle
- Add a setting under **Terminal** settings group
- Setting key: autoScrollOnSwitch (or similar — Claude's discretion on exact naming)
- **Enabled by default** with `!== false` guard (safe upgrade path, undefined = enabled)
- Call-time `getSetting()` read so toggle takes effect immediately without reload

### Claude's Discretion
- Exact setting key name and i18n label text
- Whether to use `scrollToBottom()` or `terminal.scrollToLine(terminal.buffer.active.length)` or equivalent xterm API
- Timing/delay if needed to ensure terminal is fully rendered before scrolling

</decisions>

<specifics>
## Specific Ideas

No specific requirements — standard scroll-to-bottom behavior on navigation events. Follow established patterns from Phase 6.2 for xterm scroll API usage.

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 20.1-always-scrolltoend-on-switching-tabs-or-projects*
*Context gathered: 2026-02-27*
