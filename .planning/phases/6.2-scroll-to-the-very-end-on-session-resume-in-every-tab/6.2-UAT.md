---
status: resolved
phase: 6.2-scroll-to-the-very-end-on-session-resume-in-every-tab
source: [6.2-01-SUMMARY.md]
started: 2026-02-26T17:00:00Z
updated: 2026-02-26T17:01:00Z
---

## Current Test

[testing complete]

## Tests

### 1. Restored terminal tabs scroll to bottom on app restart
expected: After restarting the app with existing terminal sessions, every restored terminal tab shows the most recent output at the very bottom of the viewport — not stuck at a mid-session scroll position.
result: skipped
reason: Same issue as test 2 — race condition with loading

### 2. Resumed Claude session scrolls to bottom after history replay
expected: A Claude terminal tab that resumes with --resume dismisses its loading overlay and the terminal is scrolled to the very bottom, showing the latest prompt/output line.
result: issue
reported: "same issue as test 1 - not perfect, race condition with loading still happening after resume"
severity: major

### 3. Chat-mode tabs produce no errors
expected: If any chat-mode tabs exist, the app restarts without JavaScript errors related to scrollToBottom (no TypeError on null terminal). Check DevTools console.
result: skipped

### 4. Non-active restored tabs scroll to bottom when switched to
expected: After restart, switch between different restored terminal tabs. Each tab you switch to should already be scrolled to the bottom showing the most recent output.
result: issue
reported: "same race condition as test 2 - scroll fires before content fully loaded"
severity: major

## Summary

total: 4
passed: 0
issues: 2
pending: 0
skipped: 2

## Gaps

- truth: "Resumed Claude sessions and restored terminals scroll to bottom after all content has loaded"
  status: resolved
  reason: "User reported: not perfect - race condition, scroll fires while loading is still happening after resume"
  severity: major
  test: 2
  root_cause: "No replay-complete signal exists. The 200ms setTimeout fires before session history finishes writing (unbounded data). The loading->ready scrollToBottom fires synchronously in the title-change handler while earlier IPC batches are still queued. Both races stem from the same gap: no silence detection."
  artifacts:
    - path: "renderer.js"
      issue: "setTimeout(200) fires before session replay data finishes arriving"
    - path: "src/renderer/ui/components/TerminalManager.js"
      issue: "scrollToBottom in updateTerminalStatus fires while earlier IPC data batches still queued"
  missing:
    - "Replace fixed 200ms timeout with PTY silence detection using existing lastTerminalData map (300ms silence = replay done, 8s hard fallback)"
    - "Remove or wrap the scrollToBottom in updateTerminalStatus loading->ready branch"
  debug_session: ".planning/debug/scroll-to-bottom-race-condition.md"
