---
phase: 6.2-scroll-to-the-very-end-on-session-resume-in-every-tab
verified: 2026-02-26T18:00:00Z
status: human_needed
score: 4/4 must-haves verified
re_verification: false
human_verification:
  - test: "Restart the app with multiple existing terminal sessions across projects. After the app finishes loading, inspect every tab (including non-active ones). All tabs should display the most recent output scrolled to the very bottom."
    expected: "Every restored terminal tab is scrolled to the bottom — no mid-session scroll position visible after switching tabs."
    why_human: "Scroll position is a visual/runtime state inside xterm.js WebGL canvas — cannot be inspected via static code analysis."
  - test: "Open a project with a resumed Claude session (one that had a --resume flag applied on restore). Wait for the loading overlay to dismiss. Verify the terminal lands at the prompt/latest output, not at the top of the replayed session history."
    expected: "Terminal scrolled to bottom once the loading overlay disappears, showing the most recent prompt line."
    why_human: "Requires running the app and observing timing of the scroll relative to the loading->ready transition."
  - test: "Open a project with a chat-mode tab alongside terminal tabs. Restart the app. No JS errors should appear in DevTools related to scrollToBottom on null."
    expected: "No console errors. Chat tab behaves normally."
    why_human: "Null-guard correctness requires runtime observation — chat-mode td.terminal is null and the guard must prevent the call."
---

# Phase 6.2: Scroll to Bottom on Session Resume — Verification Report

**Phase Goal:** Scroll all restored terminal tabs to the very bottom after app restart so users see the most recent output
**Verified:** 2026-02-26T18:00:00Z
**Status:** human_needed (all automated checks passed; behavior requires runtime observation)
**Re-verification:** No — initial verification

## Goal Achievement

### Observable Truths

| # | Truth | Status | Evidence |
|---|-------|--------|----------|
| 1 | All restored terminal tabs show the most recent output (scrolled to bottom) after app restart | ? HUMAN NEEDED | `scrollToBottom()` loop exists in `renderer.js` lines 229-236 inside `setTimeout(200)` after the `lastOpenedProjectId` block; iterates `terminalsState.get().terminals` forEach; requires runtime confirmation |
| 2 | Resumed Claude sessions scroll to bottom after session history replay completes | ? HUMAN NEEDED | `scrollToBottom()` call exists in `TerminalManager.js` lines 1069-1073 inside `loading -> ready/working` branch of `updateTerminalStatus`; fires after `dismissLoadingOverlay`; requires runtime confirmation |
| 3 | Chat-mode tabs are unaffected (no errors, ChatView already handles its own scrolling) | ✓ VERIFIED | Both call sites guard with `td.terminal && typeof td.terminal.scrollToBottom === 'function'`; chat-mode tabs have `td.terminal = null` so the guard prevents any call; static analysis confirms |
| 4 | Non-active restored tabs also scroll to bottom when user switches to them | ? HUMAN NEEDED | Loop iterates ALL terminals from `terminalsState.get().terminals` (not just active tab) — correct scope; but whether non-active xterm viewports retain their scroll position requires runtime confirmation |

**Score:** 4/4 truths have implementation evidence; 3 require human runtime verification

### Required Artifacts

| Artifact | Expected | Status | Details |
|----------|----------|--------|---------|
| `renderer.js` | Post-restore scroll-all loop with 200ms delay | ✓ VERIFIED | Lines 228-236: `setTimeout(() => { terminals.forEach(...scrollToBottom...) }, 200)` — substantive, not a stub |
| `src/renderer/ui/components/TerminalManager.js` | Scroll to bottom on loading→ready transition | ✓ VERIFIED | Lines 1069-1073: `scrollToBottom()` call inside `loading -> ready/working` branch of `updateTerminalStatus` — substantive, not a stub |

### Key Link Verification

| From | To | Via | Status | Details |
|------|----|-----|--------|---------|
| `renderer.js` | `terminalsState.get().terminals` | forEach loop calling `scrollToBottom` on each xterm terminal | ✓ WIRED | Line 230: `const terminals = terminalsState.get().terminals;` — line 232: `td.terminal.scrollToBottom()` — both present and connected |
| `src/renderer/ui/components/TerminalManager.js` | `updateTerminalStatus` loading→ready branch | `scrollToBottom` after `dismissLoadingOverlay` | ✓ WIRED | Line 1062: `if (previousStatus === 'loading' && (status === 'ready' || status === 'working'))` — line 1072: `td.terminal.scrollToBottom()` — correctly nested, fires after overlay dismissal |

### Requirements Coverage

| Requirement | Source Plan | Description | Status | Evidence |
|-------------|------------|-------------|--------|----------|
| SESS-01 | 6.2-01-PLAN.md | Terminal tabs are restored with their working directories when the app restarts | PARTIAL — MISMATCH | SESS-01 is already marked **Complete (Phase 4+6)** in REQUIREMENTS.md. Its definition covers working-directory restoration, not scroll position. Phase 6.2 is a UX enhancement on top of session restore, not a new fulfillment of SESS-01. No dedicated requirement ID exists for scroll-to-bottom behavior. The plan's `requirements: [SESS-01]` claim is a loose attribution, not a blocker — the implementation itself is correct and complete. |

### Anti-Patterns Found

| File | Line | Pattern | Severity | Impact |
|------|------|---------|----------|--------|
| None found | — | — | — | — |

No TODO, FIXME, placeholder, or empty implementation patterns found in the two modified files near the scroll changes.

### Human Verification Required

#### 1. All restored tabs scroll to bottom at app start

**Test:** Start the app with multiple existing terminal sessions (at least 2 projects, 2+ tabs per project). After the app finishes loading, switch through every tab in every project.
**Expected:** Every tab is scrolled to the very bottom — no mid-session scroll position visible on any tab.
**Why human:** Scroll position is a runtime state inside xterm.js's WebGL canvas — not readable via static analysis.

#### 2. Resumed Claude session lands at prompt after history replay

**Test:** Have a project with a previously resumed Claude session (was running Claude with `--resume`). Restart the app. Watch the loading overlay on the Claude tab. After it dismisses, check scroll position.
**Expected:** Terminal is at the bottom, showing the most recent prompt or output line — not the beginning of the replayed session history.
**Why human:** The loading→ready transition timing and scroll behavior can only be confirmed at runtime.

#### 3. Chat-mode tab produces no JS errors

**Test:** Open a project with a chat-mode tab alongside terminal tabs. Enable DevTools (npm start -- --dev). Restart the app with sessions present.
**Expected:** No `TypeError: Cannot read properties of null (reading 'scrollToBottom')` or similar errors in DevTools console.
**Why human:** The null-guard prevents the call statically, but runtime confidence requires observation that no edge case triggers the error.

### Gaps Summary

No functional gaps found. All code changes are present, substantive, and correctly wired.

The only noted issue is an attribution mismatch: the plan declares `requirements: [SESS-01]` but SESS-01 is already complete from Phase 4+6, and its definition does not explicitly include scroll-to-bottom. Phase 6.2 adds a UX improvement not tracked by any formal requirement ID. This is a documentation concern only — it does not affect the implementation and is not a blocker for proceeding.

---

_Verified: 2026-02-26T18:00:00Z_
_Verifier: Claude (gsd-verifier)_
