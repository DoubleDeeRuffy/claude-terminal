---
phase: 1.1-dotfile-visibility-setting
plan: 01
subsystem: ui
tags: [settings, file-explorer, dotfiles, i18n]

# Dependency graph
requires:
  - phase: 01-dotfile-visibility
    provides: FileExplorer.js with IGNORE_PATTERNS and dotfile filter removed (Phase 1)
provides:
  - showDotfiles setting key in defaultSettings (true by default)
  - Explorer group with show-dotfiles-toggle in General settings tab
  - saveSettingsHandler reads and persists showDotfiles
  - readDirectoryAsync filters dotfiles when showDotfiles === false
  - collectAllFiles filters dotfiles when showDotfiles === false
  - EN + FR i18n keys for explorerGroup, showDotfiles, showDotfilesDesc
affects: [FileExplorer, SettingsPanel, settings.state]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Call-time getSetting read (not cached) inside async function body — ensures toggle takes effect immediately on next folder expand or search"
    - "=== false guard (not !value) so undefined/missing defaults to show dotfiles — safe upgrade behavior for existing users"
    - "!== false guard on checkbox default (not === true) — undefined defaults to enabled/checked"

key-files:
  created: []
  modified:
    - src/renderer/state/settings.state.js
    - src/renderer/ui/panels/SettingsPanel.js
    - src/renderer/ui/components/FileExplorer.js
    - src/renderer/i18n/locales/en.json
    - src/renderer/i18n/locales/fr.json

key-decisions:
  - "showDotfiles defaults to true — no behavior change for existing users who upgrade"
  - "Use getSetting('showDotfiles') call-time (not module-level) inside readDirectoryAsync and collectAllFiles — toggle takes effect immediately without project reload"
  - "Filter uses === false guard — undefined/missing key defaults to showing dotfiles (safe upgrade path)"
  - "Explorer group inserted between System group and Quick Action Presets in General settings tab"
  - "Lazy require of settings.state inside function body — avoids circular dep issues"

patterns-established:
  - "Call-time getSetting pattern: lazy-require + read inside function body, not module-level"

requirements-completed: [FILE-01, FILE-02]

# Metrics
duration: 8min
completed: 2026-02-25
---

# Phase 1.1 Plan 01: Dotfile Visibility Setting Summary

**showDotfiles toggle in General settings Explorer group, filtering both FileExplorer tree and search when disabled, with EN+FR i18n**

## Performance

- **Duration:** ~8 min
- **Started:** 2026-02-25T00:00:00Z
- **Completed:** 2026-02-25T00:08:00Z
- **Tasks:** 2
- **Files modified:** 5

## Accomplishments
- Added `showDotfiles: true` to defaultSettings in settings.state.js — existing users see no behavior change
- Inserted Explorer settings group with toggle (defaults checked) between System group and Quick Action Presets
- saveSettingsHandler reads `show-dotfiles-toggle` and persists `showDotfiles` in newSettings
- Both `readDirectoryAsync` (tree) and `collectAllFiles` (search) skip dotfiles when `showDotfiles === false`
- All 262 Jest tests pass with no regressions

## Task Commits

Each task was committed atomically:

1. **Task 1: Add showDotfiles setting, Explorer toggle UI, i18n keys, and save handler** - `1020f63` (feat)
2. **Task 2: Add dotfile filter to FileExplorer tree and search paths, build renderer** - `2b92bb4` (feat)

## Files Created/Modified
- `src/renderer/state/settings.state.js` - Added `showDotfiles: true` to defaultSettings
- `src/renderer/ui/panels/SettingsPanel.js` - Explorer group HTML + saveSettingsHandler read/persist
- `src/renderer/ui/components/FileExplorer.js` - Dotfile filter in readDirectoryAsync and collectAllFiles
- `src/renderer/i18n/locales/en.json` - explorerGroup, showDotfiles, showDotfilesDesc keys
- `src/renderer/i18n/locales/fr.json` - explorerGroup, showDotfiles, showDotfilesDesc keys (French)

## Decisions Made
- `showDotfiles` defaults to `true` — preserves Phase 1's "show all" behavior for existing users
- Call-time `getSetting('showDotfiles')` read inside function body (lazy require pattern from Phase 04/07) — toggle takes effect on next folder expand or search, no reload needed
- `=== false` guard (not `!value`) ensures `undefined`/missing setting defaults to showing dotfiles
- `!== false` pattern on checkbox HTML so new users (undefined setting) see it checked by default

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
None.

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Dotfile visibility toggle is fully wired end-to-end
- Phase 1.1 complete — no further plans in this phase
- All success criteria met: showDotfiles in defaultSettings, Explorer group renders with toggle, saveSettingsHandler persists, both FileExplorer code paths filter, EN+FR i18n keys present, build succeeds, tests pass

---
*Phase: 1.1-dotfile-visibility-setting*
*Completed: 2026-02-25*
