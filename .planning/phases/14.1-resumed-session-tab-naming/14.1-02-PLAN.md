---
phase: 14.1-resumed-session-tab-naming
plan: "02"
type: execute
wave: 1
depends_on: ["14.1-01"]
files_modified:
  - src/renderer/ui/components/TerminalManager.js
autonomous: true
gap_closure: true
requirements: [SESS-RESUME-01, TAB-RESUME-01]

must_haves:
  truths:
    - "When user resumes a session with a saved name, the tab shows that name immediately and keeps it — no eternal 'Resume...'"
  artifacts:
    - path: "src/renderer/ui/components/TerminalManager.js"
      provides: "termData in resumeSession() includes claudeSessionId so updateTerminalTabName guard passes"
      contains: "claudeSessionId: sessionId"
  key_links:
    - from: "resumeSession() termData"
      to: "updateTerminalTabName() guard"
      via: "termData.claudeSessionId"
      pattern: "claudeSessionId: sessionId"
---

<objective>
Fix the UAT gap: resumed terminal tabs stay frozen at "Resume..." because `resumeSession()` builds `termData` without `claudeSessionId`, causing `updateTerminalTabName()`'s guard `(termData.claudeSessionId && name)` to always be false. The haiku AI name is never written to session-names.json, so on next render `isRenamed=false`, the click handler passes `name: null`, and the tab stays "Resume...".

Purpose: Thread `claudeSessionId` into `termData` in `resumeSession()` — one-line fix mirroring the existing pattern in `createTerminal()` at line 1460.
Output: `termData` object in `resumeSession()` carries `claudeSessionId: sessionId`, unblocking the downstream save path.
</objective>

<execution_context>
@C:/Users/uhgde/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/uhgde/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14.1-resumed-session-tab-naming/14.1-01-SUMMARY.md

<interfaces>
<!-- Key contracts the executor needs. No codebase exploration required. -->

From src/renderer/ui/components/TerminalManager.js — the two relevant sites:

createTerminal() line 1455-1463 (THE PATTERN TO MIRROR):
```js
const termData = {
  // ...
  mode: 'terminal',
  cwd: overrideCwd || project.path,
  ...(resumeSessionId ? { claudeSessionId: resumeSessionId } : {}),  // <-- line 1460
  ...(initialPrompt ? { pendingPrompt: initialPrompt } : {}),
  ...(overrideCwd ? { parentProjectId: project.id } : {})
};
```

resumeSession() line 2969-2978 (THE BROKEN SITE — missing claudeSessionId):
```js
const termData = {
  terminal,
  fitAddon,
  project,
  projectIndex,
  name: sessionName || t('terminals.resuming'),
  status: 'working',
  inputBuffer: '',
  isBasic: false
  // claudeSessionId MISSING — must add: claudeSessionId: sessionId
};
```

updateTerminalTabName() guard line 1023 (WHY THE FIX MATTERS):
```js
if (termData.claudeSessionId && name) {
  setSessionCustomName(termData.claudeSessionId, name);
}
```
Without claudeSessionId on termData, this guard always short-circuits — name is never saved.

resumeSession() function signature (confirm variable name):
- sessionId parameter is available in scope at the termData object literal (line ~2934: `resumeSessionId: sessionId` is already used in the api.terminal.create call above)
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add claudeSessionId to termData in resumeSession()</name>
  <files>src/renderer/ui/components/TerminalManager.js</files>
  <action>
In `resumeSession()`, find the `termData` object literal (around line 2969). It currently ends with `isBasic: false`. Add `claudeSessionId: sessionId` as a new property immediately after `isBasic: false`.

The variable `sessionId` is already in scope in `resumeSession()` — it is the function parameter and is already used two lines above in the `api.terminal.create({ resumeSessionId: sessionId, ... })` call.

Before change:
```js
const termData = {
  terminal,
  fitAddon,
  project,
  projectIndex,
  name: sessionName || t('terminals.resuming'),
  status: 'working',
  inputBuffer: '',
  isBasic: false
};
```

After change:
```js
const termData = {
  terminal,
  fitAddon,
  project,
  projectIndex,
  name: sessionName || t('terminals.resuming'),
  status: 'working',
  inputBuffer: '',
  isBasic: false,
  claudeSessionId: sessionId
};
```

Use a plain property assignment (not conditional spread) — `sessionId` is always a non-null UUID string by the time this code runs (the api.terminal.create call above already uses it, and failure paths return early before reaching termData).

Do NOT touch any other code. This is a one-line change (add the property plus a trailing comma on the preceding line).
  </action>
  <verify>
    <automated>npm test</automated>
  </verify>
  <done>
    `termData` in `resumeSession()` includes `claudeSessionId: sessionId`. The `updateTerminalTabName()` guard `(termData.claudeSessionId && name)` now evaluates to true when a name is provided, so the haiku name is saved to session-names.json and resumed tabs display their saved name instead of staying at "Resume...". `npm test` passes with no regressions.
  </done>
</task>

</tasks>

<verification>
After the fix:
- Search for `claudeSessionId: sessionId` in `src/renderer/ui/components/TerminalManager.js` — must appear at least twice (once in createTerminal spread, once in resumeSession plain property).
- `npm test` passes.
- `npm run build:renderer` succeeds.
</verification>

<success_criteria>
- `termData` in `resumeSession()` carries `claudeSessionId: sessionId`
- `npm test` and `npm run build:renderer` both pass
- Resumed terminal tabs with a saved name display that name immediately (verified via UAT re-run)
</success_criteria>

<output>
After completion, create `.planning/phases/14.1-resumed-session-tab-naming/14.1-02-SUMMARY.md`
</output>
