# Flatpak packaging

This directory contains all files needed to publish Claude Terminal on Flathub.

## Files

| File | Description |
|------|-------------|
| `io.github.sterll.claude_terminal.yml` | Flatpak build manifest |
| `io.github.sterll.claude_terminal.desktop` | Desktop entry file |
| `io.github.sterll.claude_terminal.metainfo.xml` | App metadata for Flathub store |
| `screenshots/` | App screenshots (used in metainfo) |
| `generated-sources.json` | npm offline cache (generated by flatpak-node-generator) |

## Building locally

### Prerequisites

```bash
# Install flatpak and flatpak-builder
sudo apt install flatpak flatpak-builder  # Debian/Ubuntu
# or
sudo dnf install flatpak flatpak-builder  # Fedora

# Add Flathub remote
flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo

# Install required runtimes
flatpak install flathub org.freedesktop.Platform//23.08 org.freedesktop.Sdk//23.08
flatpak install flathub org.freedesktop.Sdk.Extension.node20//23.08
flatpak install flathub org.electronjs.Electron2.BaseApp//23.08
```

### Generate npm offline cache

```bash
# Install flatpak-node-generator
pip install flatpak-node-generator

# Generate sources from package-lock.json
flatpak-node-generator npm package-lock.json -o flatpak/generated-sources.json
```

### Build and run

```bash
flatpak-builder --force-clean build-dir flatpak/io.github.sterll.claude_terminal.yml
flatpak-builder --run build-dir flatpak/io.github.sterll.claude_terminal.yml claude-terminal
```

## Submitting to Flathub

1. Fork https://github.com/flathub/flathub
2. Create branch `new-pr/io.github.sterll.claude_terminal`
3. Create directory `io.github.sterll.claude_terminal/`
4. Copy `io.github.sterll.claude_terminal.yml` and `generated-sources.json` into it
5. Open a Pull Request

Screenshots referenced in metainfo must be committed to the main repo at:
`flatpak/screenshots/screenshot-*.png`
